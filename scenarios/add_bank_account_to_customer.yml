require:
  - customer_create.yml
scenarios:
  - name: create_bank_account
    request:
      method: POST
      href: /bank_accounts
      schema: |
        { "$ref": "../requests/bank_account.json" }
      body:
        routing_number: "0021000021"
        account_number: "9900000002"
        name: what up
        type: checkin
    response:
      status_code: 201
      schema: |
        { "$ref": "../responses/bank_accounts.json" }
  - name: add_bank_account_to_customer
    request:
      method: POST
      href: "{customer_create,customers.bank_accounts}"
      schema: |
        { "$ref": "../requests/customers/bank_accounts.json" }
      body:
        href: "{create_bank_account,bank_accounts.href}"
    response:
      schema: |
        { "$ref": "../responses/bank_accounts.json" }
      equals: |
        { "bank_accounts": [ { "links": { "customer": "{customer_create,customers.id}" } } ] }